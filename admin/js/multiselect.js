!function(t){var e={columns:1,search:!1,searchOptions:{delay:250,showOptGroups:!1,searchText:!0,searchValue:!1,onSearch:function(t){}},texts:{placeholder:"Select options",search:"Search",selectedOptions:" selected",selectAll:"Select all",unselectAll:"Unselect all",noneSelected:"None Selected"},selectAll:!1,selectGroup:!1,minHeight:200,maxHeight:null,maxWidth:null,maxPlaceholderWidth:null,maxPlaceholderOpts:10,showCheckbox:!0,checkboxAutoFit:!1,optionAttributes:[],onLoad:function(t){},onOptionClick:function(t,e){},onControlClose:function(t){},onSelectAll:function(t,e){},minSelect:!1,maxSelect:!1},o=1;function s(o,s){if(this.element=o,this.options=t.extend(!0,{},e,s),this.updateSelectAll=!0,this.updatePlaceholder=!0,!t(this.element).attr("multiple"))throw new Error("[jQuery-MultiSelect] Select list must be a multiselect list in order to use this plugin");if(this.options.search&&!this.options.searchOptions.searchText&&!this.options.searchOptions.searchValue)throw new Error("[jQuery-MultiSelect] Either searchText or searchValue should be true.");"placeholder"in this.options&&(this.options.texts.placeholder=this.options.placeholder,delete this.options.placeholder),"default"in this.options.searchOptions&&(this.options.texts.search=this.options.searchOptions.default,delete this.options.searchOptions.default),this.load()}"function"!=typeof Array.prototype.map&&(Array.prototype.map=function(e,o){return void 0===o&&(o=this),t.isArray(o)?t.map(o,e):[]}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),s.prototype={load:function(){var e=this;if("SELECT"!=e.element.nodeName||t(e.element).hasClass("jqmsLoaded"))return!0;t(e.element).addClass("jqmsLoaded").data("plugin_multiselect-instance",e),t(e.element).after('<div class="ms-options-wrap"><button type="button"><span>None Selected</span></button><div class="ms-options"><ul></ul></div></div>');var o=t(e.element).next(".ms-options-wrap").find("> button:first-child"),s=t(e.element).next(".ms-options-wrap").find("> .ms-options"),i=s.find("> ul");if(e.options.showCheckbox?e.options.checkboxAutoFit&&s.addClass("checkbox-autofit"):s.addClass("hide-checkbox"),t(e.element).prop("disabled")&&o.prop("disabled",!0),e.options.maxPlaceholderWidth&&o.css("maxWidth",e.options.maxPlaceholderWidth),e.options.maxHeight)var n=e.options.maxHeight;else n=t(window).height()-s.offset().top+t(window).scrollTop()-20;if(n=n<e.options.minHeight?e.options.minHeight:n,s.css({maxWidth:e.options.maxWidth,minHeight:e.options.minHeight,maxHeight:n}),s.bind("touchmove mousewheel DOMMouseScroll",function(e){if(t(this).outerHeight()<t(this)[0].scrollHeight){var o=e.originalEvent,s=o.wheelDelta||-o.detail;t(this).outerHeight()+t(this)[0].scrollTop>t(this)[0].scrollHeight&&(e.preventDefault(),this.scrollTop+=s<0?1:-1)}}),t(document).off("click.ms-hideopts").on("click.ms-hideopts",function(e){t(e.target).closest(".ms-options-wrap").length||t(".ms-options-wrap.ms-active > .ms-options").each(function(){t(this).closest(".ms-options-wrap").removeClass("ms-active");var e=t(this).parent().prev(".jqmsLoaded").data("plugin_multiselect-instance");"function"==typeof e.options.onControlClose&&e.options.onControlClose(e.element)})}).bind("keydown",function(e){27==(e.keyCode||e.which)&&t(this).trigger("click.ms-hideopts")}),o.bind("keydown",function(t){var e=t.keyCode||t.which;13!=e&&32!=e||o.trigger("mousedown")}),o.bind("mousedown",function(o){if(o.which&&1!=o.which)return!0;if(t(".ms-options-wrap.ms-active > .ms-options").each(function(){if(t(this).parent().prev()[0]!=s.parent().prev()[0]){t(this).closest(".ms-options-wrap").removeClass("ms-active");var e=t(this).parent().prev(".jqmsLoaded").data("plugin_multiselect-instance");"function"==typeof e.options.onControlClose&&e.options.onControlClose(e.element)}}),s.closest(".ms-options-wrap").toggleClass("ms-active"),s.closest(".ms-options-wrap").hasClass("ms-active")){if(s.css("maxHeight",""),e.options.maxHeight)var i=e.options.maxHeight;else i=t(window).height()-s.offset().top+t(window).scrollTop()-20;i&&(i=i<e.options.minHeight?e.options.minHeight:i,s.css("maxHeight",i))}else"function"==typeof e.options.onControlClose&&e.options.onControlClose(e.element)}).click(function(t){t.preventDefault()}),e.options.texts.placeholder&&o.find("span").text(e.options.texts.placeholder),e.options.search){i.before('<div class="ms-search"><input type="text" value="" placeholder="'+e.options.texts.search+'" /></div>');var l=s.find(".ms-search input");l.on("keyup",function(){if(t(this).data("lastsearch")==t(this).val())return!0;t(this).data("searchTimeout")&&clearTimeout(t(this).data("searchTimeout"));var o=t(this);t(this).data("searchTimeout",setTimeout(function(){o.data("lastsearch",o.val()),"function"==typeof e.options.searchOptions.onSearch&&e.options.searchOptions.onSearch(e.element);var s=t.trim(l.val().toLowerCase());s?(i.find('li[data-search-term*="'+s+'"]:not(.optgroup)').removeClass("ms-hidden"),i.find('li:not([data-search-term*="'+s+'"], .optgroup)').addClass("ms-hidden")):i.find(".ms-hidden").removeClass("ms-hidden"),e.options.searchOptions.showOptGroups||i.find(".optgroup").each(function(){t(this).find("li:not(.ms-hidden)").length?t(this).show():t(this).hide()}),e._updateSelectAllText()},e.options.searchOptions.delay))})}e.options.selectAll&&i.before('<a href="#" class="ms-selectall global">'+e.options.texts.selectAll+"</a>"),s.on("click",".ms-selectall",function(o){o.preventDefault(),e.updateSelectAll=!1,e.updatePlaceholder=!1;var n=s.parent().prev();if(t(this).hasClass("global"))i.find("li:not(.optgroup, .selected, .ms-hidden)").length?(i.find("li:not(.optgroup, .selected, .ms-hidden)").addClass("selected"),i.find('li.selected input[type="checkbox"]:not(:disabled)').prop("checked",!0)):(i.find("li:not(.optgroup, .ms-hidden).selected").removeClass("selected"),i.find('li:not(.optgroup, .ms-hidden, .selected) input[type="checkbox"]:not(:disabled)').prop("checked",!1));else if(t(this).closest("li").hasClass("optgroup")){var l=t(this).closest("li.optgroup");l.find("li:not(.selected, .ms-hidden)").length?(l.find("li:not(.selected, .ms-hidden)").addClass("selected"),l.find('li.selected input[type="checkbox"]:not(:disabled)').prop("checked",!0)):(l.find("li:not(.ms-hidden).selected").removeClass("selected"),l.find('li:not(.ms-hidden, .selected) input[type="checkbox"]:not(:disabled)').prop("checked",!1))}var a=[];i.find('li.selected input[type="checkbox"]').each(function(){a.push(t(this).val())}),n.val(a).trigger("change"),e.updateSelectAll=!0,e.updatePlaceholder=!0,"function"==typeof e.options.onSelectAll&&e.options.onSelectAll(e.element,a.length),e._updateSelectAllText(),e._updatePlaceholderText()});var a=[];t(e.element).children().each(function(){if("OPTGROUP"==this.nodeName){var o=[];t(this).children("option").each(function(){for(var s={},i=0;i<e.options.optionAttributes.length;i++){var n=e.options.optionAttributes[i];void 0!==t(this).attr(n)&&(s[n]=t(this).attr(n))}o.push({name:t(this).text(),value:t(this).val(),checked:t(this).prop("selected"),attributes:s})}),a.push({label:t(this).attr("label"),options:o})}else{if("OPTION"!=this.nodeName)return!0;for(var s={},i=0;i<e.options.optionAttributes.length;i++){var n=e.options.optionAttributes[i];void 0!==t(this).attr(n)&&(s[n]=t(this).attr(n))}a.push({name:t(this).text(),value:t(this).val(),checked:t(this).prop("selected"),attributes:s})}}),e.loadOptions(a,!0,!1),s.on("click",'input[type="checkbox"]',function(){t(this).closest("li").toggleClass("selected"),s.parent().prev().find('option[value="'+t(this).val()+'"]').prop("selected",t(this).is(":checked")).closest("select").trigger("change"),"function"==typeof e.options.onOptionClick&&e.options.onOptionClick(e.element,this),e._updateSelectAllText(),e._updatePlaceholderText()}),s.on("focusin",'input[type="checkbox"]',function(){t(this).closest("label").addClass("focused")}).on("focusout",'input[type="checkbox"]',function(){t(this).closest("label").removeClass("focused")}),"function"==typeof e.options.onLoad&&e.options.onLoad(e.element),t(e.element).hide()},loadOptions:function(e,o,s){o="boolean"!=typeof o||o,s="boolean"!=typeof s||s;var i=this,n=t(i.element),l=n.next(".ms-options-wrap").find("> .ms-options > ul"),a=n.next(".ms-options-wrap").find("> .ms-options");o&&(l.find("> li").remove(),s&&n.find("> *").remove());var p=[];for(var c in e)if(e.hasOwnProperty(c)){var r=e[c],h=t("<li/>"),d=!0;if(r.hasOwnProperty("value")){if(i.options.showCheckbox&&i.options.checkboxAutoFit&&h.addClass("ms-reflow"),i._addOption(h,r),s){var u=t('<option value="'+r.value+'">'+r.name+"</option>");r.hasOwnProperty("attributes")&&Object.keys(r.attributes).length&&u.attr(r.attributes),r.checked&&u.prop("selected",!0),n.append(u)}}else{if(!r.hasOwnProperty("options"))continue;var m=t('<optgroup label="'+r.label+'"></optgroup>');l.find("> li.optgroup > span.label").each(function(){t(this).text()==r.label&&(h=t(this).closest(".optgroup"),d=!1)}),s&&(n.find('optgroup[label="'+r.label+'"]').length?m=n.find('optgroup[label="'+r.label+'"]'):n.append(m)),d&&(h.addClass("optgroup"),h.append('<span class="label">'+r.label+"</span>"),h.find("> .label").css({clear:"both"}),i.options.selectGroup&&h.append('<a href="#" class="ms-selectall">'+i.options.texts.selectAll+"</a>"),h.append("<ul/>"));for(var f in r.options)if(r.options.hasOwnProperty(f)){var v=r.options[f],g=t("<li/>");if(i.options.showCheckbox&&i.options.checkboxAutoFit&&g.addClass("ms-reflow"),v.hasOwnProperty("value")&&(i._addOption(g,v),h.find("> ul").append(g),s)){u=t('<option value="'+v.value+'">'+v.name+"</option>");v.hasOwnProperty("attributes")&&Object.keys(v.attributes).length&&u.attr(v.attributes),v.checked&&u.prop("selected",!0),m.append(u)}}}d&&p.push(h)}if(l.append(p),i.options.checkboxAutoFit&&i.options.showCheckbox&&!a.hasClass("hide-checkbox")){var b=l.find('.ms-reflow:eq(0) input[type="checkbox"]');if(b.length){var x=b.outerWidth();x=x||15,l.find(".ms-reflow label").css("padding-left",2*parseInt(b.closest("label").css("padding-left"))+x),l.find(".ms-reflow").removeClass("ms-reflow")}}i._updatePlaceholderText(),a.find("ul").css({"column-count":"","column-gap":"","-webkit-column-count":"","-webkit-column-gap":"","-moz-column-count":"","-moz-column-gap":""}),n.find("optgroup").length?(l.find("> li:not(.optgroup)").css({float:"left",width:100/i.options.columns+"%"}),l.find("li.optgroup").css({clear:"both"}).find("> ul").css({"column-count":i.options.columns,"column-gap":0,"-webkit-column-count":i.options.columns,"-webkit-column-gap":0,"-moz-column-count":i.options.columns,"-moz-column-gap":0}),this._ieVersion()&&this._ieVersion()<10&&l.find("li.optgroup > ul > li").css({float:"left",width:100/i.options.columns+"%"})):(l.css({"column-count":i.options.columns,"column-gap":0,"-webkit-column-count":i.options.columns,"-webkit-column-gap":0,"-moz-column-count":i.options.columns,"-moz-column-gap":0}),this._ieVersion()&&this._ieVersion()<10&&l.find("> li").css({float:"left",width:100/i.options.columns+"%"})),i._updateSelectAllText()},settings:function(e){this.options=t.extend(!0,{},this.options,e),this.reload()},unload:function(){t(this.element).next(".ms-options-wrap").remove(),t(this.element).show(function(){t(this).css("display","").removeClass("jqmsLoaded")})},reload:function(){t(this.element).next(".ms-options-wrap").remove(),t(this.element).removeClass("jqmsLoaded"),this.load()},reset:function(){var e=[];t(this.element).find("option").each(function(){t(this).prop("defaultSelected")&&e.push(t(this).val())}),t(this.element).val(e),this.reload()},disable:function(e){e="boolean"!=typeof e||e,t(this.element).prop("disabled",e),t(this.element).next(".ms-options-wrap").find("button:first-child").prop("disabled",e)},_updateSelectAllText:function(){if(this.updateSelectAll){var e=this;if(e.options.selectAll||e.options.selectGroup)t(e.element).next(".ms-options-wrap").find("> .ms-options").find(".ms-selectall").each(function(){var o=t(this).parent().find("li:not(.optgroup,.selected,.ms-hidden)");t(this).text(o.length?e.options.texts.selectAll:e.options.texts.unselectAll)})}},_updatePlaceholderText:function(){if(this.updatePlaceholder){var e=t(this.element),o=e.val()?e.val():[],s=e.next(".ms-options-wrap").find("> button:first-child"),i=s.find("span"),n=e.next(".ms-options-wrap").find("> .ms-options");e.find("option:selected:disabled").length&&(o=[],e.find("option:selected").each(function(){o.push(t(this).val())}));var l=[];for(var a in o)if(o.hasOwnProperty(a)&&(l.push(t.trim(e.find('option[value="'+o[a]+'"]').text())),l.length>=this.options.maxPlaceholderOpts))break;i.text(l.join(", ")),l.length?n.closest(".ms-options-wrap").addClass("ms-has-selections"):n.closest(".ms-options-wrap").removeClass("ms-has-selections"),l.length?(i.width()>s.width()||l.length!=o.length)&&i.text(o.length+this.options.texts.selectedOptions):i.text(this.options.texts.placeholder)}},_addOption:function(e,s){var i=t("<label/>",{for:"ms-opt-"+o,text:s.name}),n=t("<input>",{type:"checkbox",title:s.name,id:"ms-opt-"+o,value:s.value});s.hasOwnProperty("attributes")&&Object.keys(s.attributes).length&&n.attr(s.attributes),s.checked&&(e.addClass("default selected"),n.prop("checked",!0)),i.prepend(n);var l="";this.options.searchOptions.searchText&&(l+=" "+s.name.toLowerCase()),this.options.searchOptions.searchValue&&(l+=" "+s.value.toLowerCase()),e.attr("data-search-term",t.trim(l)).prepend(i),o+=1},_ieVersion:function(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")&&parseInt(t.split("msie")[1])}},t.fn.multiselect=function(e){if(this.length){var o,i=arguments;return void 0===e||"object"==typeof e?this.each(function(){t.data(this,"plugin_multiselect")||t.data(this,"plugin_multiselect",new s(this,e))}):"string"==typeof e&&"_"!==e[0]&&"init"!==e?(this.each(function(){var n=t.data(this,"plugin_multiselect");n instanceof s&&"function"==typeof n[e]&&(o=n[e].apply(n,Array.prototype.slice.call(i,1))),"unload"===e&&t.data(this,"plugin_multiselect",null)}),o):void 0}}}(jQuery);